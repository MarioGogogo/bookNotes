(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{182:function(t,e,s){"use strict";s.r(e);var r=s(0),a=Object(r.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("p",[t._v("原文地址 https://juejin.im/post/5ba1f995f265da0a972e1657")]),t._v(" "),t._m(1),t._v(" "),s("p",[t._v("React16.5 正式在 devtool 中加入了 Profiler 功能，用于收集每次变更导致的渲染时间，帮助开发者发现潜在的性能问题，有助于开发更高性能的 React 应用")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://reactjs.org/blog/2018/09/10/introducing-the-react-profiler.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方博客"),s("OutboundLink")],1)]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),s("p",[t._v("在你使用 React16.5 之后的版本中，开发时默认开启 Profiler 功能，要想在正是环境也使用这个功能，可以"),s("a",{attrs:{href:"https://gist.github.com/bvaughn/25e6233aeb1b4f0cdb8d8366e54a3977",target:"_blank",rel:"noopener noreferrer"}},[t._v("看这里"),s("OutboundLink")],1)]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),s("p",[t._v("你可以点击任何一个组件来查看他的详细信息")]),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),s("p",[t._v("如果你需要查看在你进行录制的过程中，某个组件被渲染了多少次，每次所用的时间，那么这个视图就是为你准备的。")]),t._v(" "),t._m(32),t._v(" "),s("p",[t._v("一看像一个柱状图，每一条代表一次渲染，长度和颜色代表时间的长短。")]),t._v(" "),s("p",[t._v("你可以通过双击一个组件，或者选中一个组件，点击右上角的图标来打开该视图。")]),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._v(" "),t._m(39),t._v(" "),t._m(40),t._v(" "),t._m(41),t._v(" "),t._m(42),s("p",[t._v("更详细的使用可以"),s("a",{attrs:{href:"https://gist.github.com/bvaughn/8de925562903afd2e7a12554adcdda16",target:"_blank",rel:"noopener noreferrer"}},[t._v("看这里"),s("OutboundLink")],1)]),t._v(" "),t._m(43),t._v(" "),s("p",[t._v("这个功能非常棒，它能够让开发者非常直观的看到他的每次操作带来的组件渲染消耗，能够很方便帮助开发者发现一些不必要的渲染。")]),t._v(" "),s("p",[t._v("其实在 React 开发中一些小细节可能会给整个应用的性能开销带来很大的影响，只是现在的浏览器太强大以及大部分应用都处于性能过剩的情况下，所以性能问题不是特别明显。")]),t._v(" "),s("p",[t._v("在"),s("a",{attrs:{href:"https://reactjs.org/blog/2018/09/10/introducing-the-react-profiler.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("原文"),s("OutboundLink")],1),t._v("的最后有一个视频展示了如何利用"),s("code",[t._v("Profiler")]),t._v("帮助发现性能问题并优化的案例，大家都可以看一下。")])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"react-性能分析利器来了"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#react-性能分析利器来了","aria-hidden":"true"}},[this._v("#")]),this._v(" React 性能分析利器来了")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"profiler"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#profiler","aria-hidden":"true"}},[this._v("#")]),this._v(" Profiler")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"如何使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何使用","aria-hidden":"true"}},[this._v("#")]),this._v(" 如何使用")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("在 Chrome 的开发工具插件"),e("code",[this._v("react devtool")]),this._v("中多了一个"),e("code",[this._v("Profiler")]),this._v("的 tab，点击可以切换到"),e("code",[this._v("Profiler")]),this._v("界面")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/20191022223905.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("默认打开"),e("code",[this._v("Profiler")]),this._v("什么都没有，要点击录制按钮进行记录（跟 chrome 的 performance 挺像）。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/20191022223928.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("在你开始录制之后你可以进行一些你想分析的操作，然后再点击"),e("code",[this._v("stop")]),this._v("来停止录制，就可以得到录制的内容")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/20191022223957.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"录制内容分析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#录制内容分析","aria-hidden":"true"}},[this._v("#")]),this._v(" 录制内容分析")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("首先要了解一点，"),e("strong",[this._v("React 在 16")]),this._v(" 版本之后处理任务分为两个阶段：")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ol",[s("li",[s("strong",[t._v("render")]),t._v(" 阶段判断哪些变更需要被处理成 DOM，也就是比较上一次渲染的结果和新的更新")]),t._v(" "),s("li",[s("strong",[t._v("commit")]),t._v(" 阶段 React 最终达成所有变更（也就是从 js 对象到 DOM 的更新），并且会调用"),s("code",[t._v("componentDidMount")]),t._v("和"),s("code",[t._v("componentDidUpdate")]),t._v("这些生命周期方法")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("开发工具中通过"),e("code",[this._v("commit")]),this._v("阶段对性能数据进行编组，会显示在右侧工具栏上")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/20191022224025.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("看上去像一个柱状图，每一个柱子代表一次"),e("code",[this._v("commit")]),this._v("，他的颜色和高度对应执行时长，越高颜色越黄代表时间越长，反之越短。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"删选-commits"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#删选-commits","aria-hidden":"true"}},[this._v("#")]),this._v(" 删选 commits")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("可以通过"),e("code",[this._v("commits")]),this._v("分组左边的设置图标点击出现的对话框设置删选选项，可以设置：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("执行时间少于多少的不展示")]),this._v(" "),e("li",[this._v("是否显示原声 DOM 渲染的时间")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/165f0b6d98c5f305.jpg",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"火焰图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#火焰图","aria-hidden":"true"}},[this._v("#")]),this._v(" 火焰图")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("火焰图部分会以一个类似树形的结构显示一次"),e("code",[this._v("commit")]),this._v("过程中整个每个组件的渲染信息，跟"),e("code",[this._v("commit")]),this._v("分组信息类似，颜色和长短对应这个组件的渲染耗时，当然组件的渲染时间需要依赖他的子组件的渲染时间。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/20191022224258.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("上图中可见"),e("code",[this._v("Router")]),this._v("组件渲染时间最长，也基本等于"),e("code",[this._v("Nav")]),this._v("和"),e("code",[this._v("Route")]),this._v("的渲染时间之和，因为子组件的渲染最终肯定会被计算在父组件的渲染时间内。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/265f0b6de65874ea.jpg",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("点击一个组件还可以查看他的"),e("code",[this._v("props")]),this._v("和"),e("code",[this._v("state")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/365f0b6dec6c813c.jpg",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("有些时候你选中一个组件，在"),e("code",[this._v("commits")]),this._v("分组中进行切换，在"),e("code",[this._v("state")]),this._v("和"),e("code",[this._v("props")]),this._v("面板会有内容变化的提示")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/465f0b6e0b3942e6.jpg",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"排名视图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#排名视图","aria-hidden":"true"}},[this._v("#")]),this._v(" 排名视图")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("选中火焰图边上的排名视图，会展示该次"),e("code",[this._v("commit")]),this._v("中组件渲染时间由高到低的排名，方便删选最长时间的渲染。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/20191022224624.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"组件视图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#组件视图","aria-hidden":"true"}},[this._v("#")]),this._v(" 组件视图")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/20191022224739.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/565f0b6e6786a4b8.jpg",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"互动？（interactions-不知道怎么翻译好）"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#互动？（interactions-不知道怎么翻译好）","aria-hidden":"true"}},[this._v("#")]),this._v(" 互动？（Interactions 不知道怎么翻译好）")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("在之前 React 已经发布了一组实验 API 来追踪更新的"),e("em",[this._v("原因")]),this._v("，使用这个 API 的信息也会在 devtool 中展示")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/20191022224830.png",alt:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("途中四个绿点就是调用 API 的节点对应的"),s("code",[t._v("commit")]),t._v("，同时你也可以在火焰图的"),s("code",[t._v("commit")]),t._v("信息中看到在这个"),s("code",[t._v("commit")]),t._v("存在的"),s("em",[t._v("活动追踪")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/20191022224853.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("你可以在"),e("em",[this._v("互动")]),this._v("和"),e("code",[this._v("commits")]),this._v("之间进行切换通过点击对应的信息")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"http://book.52react.cn/665f0b6e6b567553.jpg",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("顺带提一下，这个 API 通过"),e("code",[this._v("scheduler")]),this._v("这个包使用")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" unstable_trace "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" trace "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"schedule/tracing"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyComponent")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Component")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handleLoginButtonClick")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("trace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Login button click"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" performance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" isLoggingIn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// render ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"最后"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#最后","aria-hidden":"true"}},[this._v("#")]),this._v(" 最后")])}],!1,null,null,null);e.default=a.exports}}]);